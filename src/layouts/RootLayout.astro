---
import { ClientRouter } from "astro:transitions";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";

import { CURRENT_SEASON, Modes, Seasons, SEASONS } from "../consts";

type Props = {
  title?: string;
  description?: string;
  season?: Seasons;
  autoDetectSeason?: boolean;
};

const { title, description, season } = Astro.props;

const currentSeason = (season || CURRENT_SEASON) as Seasons;
---

<!doctype html>
<html lang="en" data-season={currentSeason}>
  <head>
    <script is:inline>
      let mode = localStorage.getItem("mode");

      if (!mode) {
        if (
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches
        ) {
          mode = "dark";
        } else {
          mode = "light";
        }
      }

      localStorage.setItem("mode", mode);
      document.querySelector("html").classList.add(mode);
      window.MODE = mode;
    </script>
    <BaseHead title={title} description={description} />
    <!-- <ClientRouter /> -->
  </head>
  <body class="bg-inherit">
    <Header season={currentSeason} transition:persist="false" />
    <main
      class="relative z-[1] max-w-5xl mx-auto w-full bg-inherit px-4"
      id="main"
    >
      <slot />
    </main>
    <Footer />
  </body>
</html>
